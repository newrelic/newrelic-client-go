// Code generated by tutone: DO NOT EDIT
package abtest

import "context"

// This calculates which experimental variation a user should see. NOTE: Calling this function will record an impression!
func (a *AbTest) AbTestGetVariation(
	experimentKey string,
	accountId string,
) (*AbTestGetVariationResponse, error) {
	return a.AbTestGetVariationWithContext(context.Background(),
	  experimentKey,
	  accountId,
	)
}

// This calculates which experimental variation a user should see. NOTE: Calling this function will record an impression!
func (a *AbTest) AbTestGetVariationWithContext(
	ctx context.Context,
	experimentKey string,
	accountId string,
) (*AbTestGetVariationResponse, error) {

	resp := AbTestGetVariationQueryResponse{}
	vars := map[string]interface{}{
		"experimentKey": experimentKey,
		"subjectKey": accountId,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, AbTestGetVariationMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.AbTestGetVariationResponse, nil
}

type AbTestGetVariationQueryResponse struct {
	AbTestGetVariationResponse AbTestGetVariationResponse `json:"AbTestGetVariation"`
}

const AbTestGetVariationMutation = `mutation {
	abTestGetVariation(
	  req: {
		experimentKey: $experimentKey,
		subjectKey: $subjectKey
	  }) {
	  variationKey
	}
  }`
