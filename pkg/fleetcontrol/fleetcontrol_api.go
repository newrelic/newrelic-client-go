// Code generated by tutone: DO NOT EDIT
package fleetcontrol

import "context"

// Adds managed entities to a fleet
func (a *Fleetcontrol) FleetControlAddFleetMembers(
	fleetId string,
	members []FleetControlFleetMemberRingInput,
) (*FleetControlFleetMembersResult, error) {
	return a.FleetControlAddFleetMembersWithContext(context.Background(),
		fleetId,
		members,
	)
}

// Adds managed entities to a fleet
func (a *Fleetcontrol) FleetControlAddFleetMembersWithContext(
	ctx context.Context,
	fleetId string,
	members []FleetControlFleetMemberRingInput,
) (*FleetControlFleetMembersResult, error) {

	resp := FleetControlAddFleetMembersQueryResponse{}
	vars := map[string]interface{}{
		"fleetId": fleetId,
		"members": members,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, FleetControlAddFleetMembersMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.FleetControlFleetMembersResult, nil
}

type FleetControlAddFleetMembersQueryResponse struct {
	FleetControlFleetMembersResult FleetControlFleetMembersResult `json:"FleetControlAddFleetMembers"`
}

const FleetControlAddFleetMembersMutation = `mutation(
	$fleetId: ID!,
	$members: [FleetControlFleetMemberRingInput!],
) { fleetControlAddFleetMembers(
	fleetId: $fleetId,
	members: $members,
) {
	fleetId
	members {
		entityIds
		ring
	}
} }`

// Create a fleet entity
func (a *Fleetcontrol) FleetControlCreateFleet(
	fleetEntity FleetControlFleetEntityCreateInput,
) (*FleetControlCreateFleetResult, error) {
	return a.FleetControlCreateFleetWithContext(context.Background(),
		fleetEntity,
	)
}

// Create a fleet entity
func (a *Fleetcontrol) FleetControlCreateFleetWithContext(
	ctx context.Context,
	fleetEntity FleetControlFleetEntityCreateInput,
) (*FleetControlCreateFleetResult, error) {

	resp := FleetControlCreateFleetQueryResponse{}
	vars := map[string]interface{}{
		"fleetEntity": fleetEntity,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, FleetControlCreateFleetMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.FleetControlCreateFleetResult, nil
}

type FleetControlCreateFleetQueryResponse struct {
	FleetControlCreateFleetResult FleetControlCreateFleetResult `json:"FleetControlCreateFleet"`
}

const FleetControlCreateFleetMutation = `mutation(
	$fleetEntity: FleetControlFleetEntityCreateInput!,
) { fleetControlCreateFleet(
	fleetEntity: $fleetEntity,
) {
	entity {
		description
		id
		managedEntityRings {
			id
			metadata {
				createdAt
				createdBy {
					id
				}
				updatedAt
				updatedBy {
					id
				}
			}
			name
			scope {
				id
				type
			}
			tags {
				key
				values
			}
			type
		}
		managedEntityType
		metadata {
			createdAt
			createdBy {
				id
			}
			updatedAt
			updatedBy {
				id
			}
		}
		name
		operatingSystem {
			type
		}
		product
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		type
	}
} }`

// Creates the fleet deployment
func (a *Fleetcontrol) FleetControlCreateFleetDeployment(
	fleetDeployment FleetControlFleetDeploymentCreateInput,
) (*FleetControlFleetDeploymentCreateResult, error) {
	return a.FleetControlCreateFleetDeploymentWithContext(context.Background(),
		fleetDeployment,
	)
}

// Creates the fleet deployment
func (a *Fleetcontrol) FleetControlCreateFleetDeploymentWithContext(
	ctx context.Context,
	fleetDeployment FleetControlFleetDeploymentCreateInput,
) (*FleetControlFleetDeploymentCreateResult, error) {

	resp := FleetControlCreateFleetDeploymentQueryResponse{}
	vars := map[string]interface{}{
		"fleetDeployment": fleetDeployment,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, FleetControlCreateFleetDeploymentMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.FleetControlFleetDeploymentCreateResult, nil
}

type FleetControlCreateFleetDeploymentQueryResponse struct {
	FleetControlFleetDeploymentCreateResult FleetControlFleetDeploymentCreateResult `json:"FleetControlCreateFleetDeployment"`
}

const FleetControlCreateFleetDeploymentMutation = `mutation(
	$fleetDeployment: FleetControlFleetDeploymentCreateInput!,
) { fleetControlCreateFleetDeployment(
	fleetDeployment: $fleetDeployment,
) {
	entity {
		configurationVersionList {
			id
		}
		description
		fleetId
		id
		metadata {
			createdAt
			createdBy {
				id
			}
			updatedAt
			updatedBy {
				id
			}
		}
		name
		phase
		ringsDeploymentTracker {
			completedAt
			name
			startedAt
			status
		}
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		type
	}
} }`

// Deletes the fleet
func (a *Fleetcontrol) FleetControlDeleteFleet(
	iD string,
) (*FleetControlDeleteFleetResult, error) {
	return a.FleetControlDeleteFleetWithContext(context.Background(),
		iD,
	)
}

// Deletes the fleet
func (a *Fleetcontrol) FleetControlDeleteFleetWithContext(
	ctx context.Context,
	iD string,
) (*FleetControlDeleteFleetResult, error) {

	resp := FleetControlDeleteFleetQueryResponse{}
	vars := map[string]interface{}{
		"id": iD,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, FleetControlDeleteFleetMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.FleetControlDeleteFleetResult, nil
}

type FleetControlDeleteFleetQueryResponse struct {
	FleetControlDeleteFleetResult FleetControlDeleteFleetResult `json:"FleetControlDeleteFleet"`
}

const FleetControlDeleteFleetMutation = `mutation(
	$id: ID!,
) { fleetControlDeleteFleet(
	id: $id,
) {
	id
} }`

// Removes managed entities from a fleet
func (a *Fleetcontrol) FleetControlRemoveFleetMembers(
	fleetId string,
	members []FleetControlFleetMemberRingInput,
) (*FleetControlFleetMembersResult, error) {
	return a.FleetControlRemoveFleetMembersWithContext(context.Background(),
		fleetId,
		members,
	)
}

// Removes managed entities from a fleet
func (a *Fleetcontrol) FleetControlRemoveFleetMembersWithContext(
	ctx context.Context,
	fleetId string,
	members []FleetControlFleetMemberRingInput,
) (*FleetControlFleetMembersResult, error) {

	resp := FleetControlRemoveFleetMembersQueryResponse{}
	vars := map[string]interface{}{
		"fleetId": fleetId,
		"members": members,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, FleetControlRemoveFleetMembersMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.FleetControlFleetMembersResult, nil
}

type FleetControlRemoveFleetMembersQueryResponse struct {
	FleetControlFleetMembersResult FleetControlFleetMembersResult `json:"FleetControlRemoveFleetMembers"`
}

const FleetControlRemoveFleetMembersMutation = `mutation(
	$fleetId: ID!,
	$members: [FleetControlFleetMemberRingInput!],
) { fleetControlRemoveFleetMembers(
	fleetId: $fleetId,
	members: $members,
) {
	fleetId
	members {
		entityIds
		ring
	}
} }`

// Updates the fleet details
func (a *Fleetcontrol) FleetControlUpdateFleet(
	fleetUpdate FleetControlUpdateFleetEntityInput,
	iD string,
) (*FleetControlUpdateFleetResult, error) {
	return a.FleetControlUpdateFleetWithContext(context.Background(),
		fleetUpdate,
		iD,
	)
}

// Updates the fleet details
func (a *Fleetcontrol) FleetControlUpdateFleetWithContext(
	ctx context.Context,
	fleetUpdate FleetControlUpdateFleetEntityInput,
	iD string,
) (*FleetControlUpdateFleetResult, error) {

	resp := FleetControlUpdateFleetQueryResponse{}
	vars := map[string]interface{}{
		"fleetUpdate": fleetUpdate,
		"id":          iD,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, FleetControlUpdateFleetMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.FleetControlUpdateFleetResult, nil
}

type FleetControlUpdateFleetQueryResponse struct {
	FleetControlUpdateFleetResult FleetControlUpdateFleetResult `json:"FleetControlUpdateFleet"`
}

const FleetControlUpdateFleetMutation = `mutation(
	$fleetUpdate: FleetControlUpdateFleetEntityInput!,
	$id: ID!,
) { fleetControlUpdateFleet(
	fleetUpdate: $fleetUpdate,
	id: $id,
) {
	entity {
		description
		id
		managedEntityRings {
			id
			metadata {
				createdAt
				createdBy {
					id
				}
				updatedAt
				updatedBy {
					id
				}
			}
			name
			scope {
				id
				type
			}
			tags {
				key
				values
			}
			type
		}
		managedEntityType
		metadata {
			createdAt
			createdBy {
				id
			}
			updatedAt
			updatedBy {
				id
			}
		}
		name
		operatingSystem {
			type
		}
		product
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		type
	}
} }`

// Updates the fleet deployment
func (a *Fleetcontrol) FleetControlUpdateFleetDeployment(
	fleetDeploymentUpdate FleetControlFleetDeploymentUpdateInput,
	iD string,
) (*FleetControlFleetDeploymentUpdateResult, error) {
	return a.FleetControlUpdateFleetDeploymentWithContext(context.Background(),
		fleetDeploymentUpdate,
		iD,
	)
}

// Updates the fleet deployment
func (a *Fleetcontrol) FleetControlUpdateFleetDeploymentWithContext(
	ctx context.Context,
	fleetDeploymentUpdate FleetControlFleetDeploymentUpdateInput,
	iD string,
) (*FleetControlFleetDeploymentUpdateResult, error) {

	resp := FleetControlUpdateFleetDeploymentQueryResponse{}
	vars := map[string]interface{}{
		"fleetDeploymentUpdate": fleetDeploymentUpdate,
		"id":                    iD,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, FleetControlUpdateFleetDeploymentMutation, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.FleetControlFleetDeploymentUpdateResult, nil
}

type FleetControlUpdateFleetDeploymentQueryResponse struct {
	FleetControlFleetDeploymentUpdateResult FleetControlFleetDeploymentUpdateResult `json:"FleetControlUpdateFleetDeployment"`
}

const FleetControlUpdateFleetDeploymentMutation = `mutation(
	$fleetDeploymentUpdate: FleetControlFleetDeploymentUpdateInput!,
	$id: ID!,
) { fleetControlUpdateFleetDeployment(
	fleetDeploymentUpdate: $fleetDeploymentUpdate,
	id: $id,
) {
	entity {
		configurationVersionList {
			id
		}
		description
		fleetId
		id
		metadata {
			createdAt
			createdBy {
				id
			}
			updatedAt
			updatedBy {
				id
			}
		}
		name
		phase
		ringsDeploymentTracker {
			completedAt
			name
			startedAt
			status
		}
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		type
	}
} }`

// Retrieves an entity.
func (a *Fleetcontrol) GetEntity(
	iD string,
) (*EntityManagementEntityInterface, error) {
	return a.GetEntityWithContext(context.Background(),
		iD,
	)
}

// Retrieves an entity.
func (a *Fleetcontrol) GetEntityWithContext(
	ctx context.Context,
	iD string,
) (*EntityManagementEntityInterface, error) {

	resp := entityResponse{}
	vars := map[string]interface{}{
		"id": iD,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, getEntityQuery, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.Actor.EntityManagement.Entity, nil
}

const getEntityQuery = `query(
	$id: ID!,
) { actor { entityManagement { entity(
	id: $id,
) {
	id
	metadata {
		createdAt
		createdBy {
			__typename
			id
			... on EntityManagementSystemActor {
				__typename
			}
			... on EntityManagementUserActor {
				__typename
			}
		}
		updatedAt
		updatedBy {
			__typename
			id
			... on EntityManagementSystemActor {
				__typename
			}
			... on EntityManagementUserActor {
				__typename
			}
		}
		version
	}
	name
	scope {
		id
		type
	}
	tags {
		key
		values
	}
	type
	... on EntityManagementAgentConfigurationEntity {
		__typename
		agentType
		configurationType
		metadata {
			createdAt
			createdBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			updatedAt
			updatedBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			version
		}
		operatingSystem {
			type
		}
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		versionCount
	}
	... on EntityManagementAgentConfigurationVersionEntity {
		__typename
		agentConfiguration
		blob {
			blobSignature {
				securityFindings
				signature {
					checksum
					checksumAlgorithm
					keyId
					signature
					signatureSpecification
					signingAlgorithm
					signingDomain
				}
				signatureError
				signatureErrors
				signatures {
					checksum
					checksumAlgorithm
					keyId
					signature
					signatureSpecification
					signingAlgorithm
					signingDomain
				}
				validationError
			}
			blobSignatures {
				securityFindings
				signature {
					checksum
					checksumAlgorithm
					keyId
					signature
					signatureSpecification
					signingAlgorithm
					signingDomain
				}
				signatureError
				signatureErrors
				signatures {
					checksum
					checksumAlgorithm
					keyId
					signature
					signatureSpecification
					signingAlgorithm
					signingDomain
				}
				validationError
			}
			checksum
			checksumAlgorithm
			contentType
			id
		}
		metadata {
			createdAt
			createdBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			updatedAt
			updatedBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			version
		}
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		version
	}
	... on EntityManagementFleetEntity {
		__typename
		currentDeployment {
			canaryManagedEntities
			configsChanged
			configurationVersions
			deployedAt
			description
			entitiesChanged
			managedEntitiesChanged
			managedEntitiesRequiredToChange
			metadata {
				createdAt
				updatedAt
				userId
			}
			name
			status
			supervisedAgentEntitiesChanged
			supervisedAgentEntitiesRequiredToChange
		}
		description
		managedEntityRings {
			id
			metadata {
				createdAt
				createdBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				updatedAt
				updatedBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				version
			}
			name
			scope {
				id
				type
			}
			tags {
				key
				values
			}
			type
		}
		managedEntityType
		metadata {
			createdAt
			createdBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			updatedAt
			updatedBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			version
		}
		operatingSystem {
			type
		}
		product
		scope {
			id
			type
		}
		tags {
			key
			values
		}
	}
} } } }`

// Retrieves a set of entities that match the given query predicate.
func (a *Fleetcontrol) GetEntitySearch(
	cursor string,
	query string,
) (*EntityManagementEntitySearchResult, error) {
	return a.GetEntitySearchWithContext(context.Background(),
		cursor,
		query,
	)
}

// Retrieves a set of entities that match the given query predicate.
func (a *Fleetcontrol) GetEntitySearchWithContext(
	ctx context.Context,
	cursor string,
	query string,
) (*EntityManagementEntitySearchResult, error) {

	resp := entitySearchResponse{}
	vars := map[string]interface{}{
		"cursor": cursor,
		"query":  query,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, getEntitySearchQuery, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.Actor.EntityManagement.EntitySearch, nil
}

const getEntitySearchQuery = `query(
	$query: String!,
) { actor { entityManagement { entitySearch(
	query: $query,
) {
	entities {
		__typename
		id
		metadata {
			createdAt
			createdBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			updatedAt
			updatedBy {
				__typename
				id
				... on EntityManagementSystemActor {
					__typename
				}
				... on EntityManagementUserActor {
					__typename
				}
			}
			version
		}
		name
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		type
		... on EntityManagementAgentConfigurationEntity {
			__typename
			agentType
			configurationType
			managedEntityType
			metadata {
				createdAt
				createdBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				updatedAt
				updatedBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				version
			}
			operatingSystem {
				type
			}
			scope {
				id
				type
			}
			tags {
				key
				values
			}
			versionCount
		}
		... on EntityManagementAgentConfigurationVersionEntity {
			__typename
			agentConfiguration
			blob {
				blobSignature {
					securityFindings
					signatureError
					signatureErrors
					validationError
				}
				blobSignatures {
					securityFindings
					signatureError
					signatureErrors
					validationError
				}
				checksum
				checksumAlgorithm
				contentType
				id
			}
			metadata {
				createdAt
				createdBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				updatedAt
				updatedBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				version
			}
			scope {
				id
				type
			}
			tags {
				key
				values
			}
			version
		}
		... on EntityManagementFleetEntity {
			__typename
			currentDeployment {
				canaryManagedEntities
				configsChanged
				configurationVersions
				deployedAt
				description
				entitiesChanged
				managedEntitiesChanged
				managedEntitiesRequiredToChange
				metadata {
					createdAt
					updatedAt
					userId
				}
				name
				status
				supervisedAgentEntitiesChanged
				supervisedAgentEntitiesRequiredToChange
			}
			description
			managedEntityRings {
				id
				metadata {
					createdAt
					updatedAt
					version
				}
				name
				scope {
					id
					type
				}
				tags {
					key
					values
				}
				type
			}
			managedEntityType
			metadata {
				createdAt
				createdBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				updatedAt
				updatedBy {
					__typename
					id
					... on EntityManagementSystemActor {
						__typename
					}
					... on EntityManagementUserActor {
						__typename
					}
				}
				version
			}
			operatingSystem {
				type
			}
			product
			scope {
				id
				type
			}
			tags {
				key
				values
			}
		}
	}
	nextCursor
} } } }`

// List managed entities for a fleet
func (a *Fleetcontrol) GetFleetMembers(
	cursor string,
	filter *FleetControlFleetMembersFilterInput,
) (*FleetControlFleetMembersItemsResult, error) {
	return a.GetFleetMembersWithContext(context.Background(),
		cursor,
		filter,
	)
}

// List managed entities for a fleet
func (a *Fleetcontrol) GetFleetMembersWithContext(
	ctx context.Context,
	cursor string,
	filter *FleetControlFleetMembersFilterInput,
) (*FleetControlFleetMembersItemsResult, error) {

	resp := fleetMembersResponse{}
	vars := map[string]interface{}{
		"cursor": cursor,
		"filter": filter,
	}

	if err := a.client.NerdGraphQueryWithContext(ctx, getFleetMembersQuery, vars, &resp); err != nil {
		return nil, err
	}

	return &resp.Actor.FleetControl.FleetMembers, nil
}

const getFleetMembersQuery = `query(
	$filter: FleetControlFleetMembersFilterInput!,
) { actor { fleetControl { fleetMembers(
	filter: $filter,
) {
	items {
		id
		metadata {
			createdAt
			updatedAt
		}
		name
		scope {
			id
			type
		}
		tags {
			key
			values
		}
		type
	}
	nextCursor
} } } }`
